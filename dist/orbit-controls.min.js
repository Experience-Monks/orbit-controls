!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self,e.orbitControls=t())}(this,function(){"use strict";function e(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}function t(e,t){var n=R(getComputedStyle(e).getPropertyValue(t));return n[0]*r(n[1],e)}function n(e,n){var r=document.createElement("div");r.style["font-size"]="128"+e,n.appendChild(r);var i=t(r,"font-size")/128;return n.removeChild(r),i}function r(e,r){switch(r=r||document.body,e=(e||"px").trim().toLowerCase(),r!==window&&r!==document||(r=document.body),e){case"%":return r.clientHeight/100;case"ch":case"ex":return n(e,r);case"em":return t(r,"font-size");case"rem":return t(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return X;case"cm":return X/2.54;case"mm":return X/25.4;case"pt":return X/72;case"pc":return X/6}return 1}function i(e,t,n){"function"==typeof e&&(n=!!t,t=e,e=window);var r=U("ex",e),i=function(e){n&&e.preventDefault();var i=e.deltaX||0,o=e.deltaY||0,s=e.deltaZ||0,u=e.deltaMode,a=1;switch(u){case 1:a=r;break;case 2:a=window.innerHeight}if(i*=a,o*=a,s*=a,i||o||s)return t(i,o,s,e)};return e.addEventListener("wheel",i),i}function o(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var r=e.clientX||0,i=e.clientY||0,o=s(t);return n[0]=r-o.left,n[1]=i-o.top,n}function s(e){return e===window||e===document||e===document.body?F:e.getBoundingClientRect()}function u(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}function a(){}function c(){c.init.call(this)}function f(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function h(e,t,n){if(t)e.call(n);else for(var r=e.length,i=b(e,r),o=0;o<r;++o)i[o].call(n)}function d(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=b(e,i),s=0;s<i;++s)o[s].call(n,r)}function l(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=b(e,o),u=0;u<o;++u)s[u].call(n,r,i)}function v(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,u=b(e,s),a=0;a<s;++a)u[a].call(n,r,i,o)}function p(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=b(e,i),s=0;s<i;++s)o[s].apply(n,r)}function m(e,t,n,r){var i,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(o=e._events,o?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new a,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=f(e))&&i>0&&s.length>i){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,g(u)}}else s=o[t]=n,++e._eventsCount;return e}function g(e){"function"==typeof console.warn?console.warn(e):console.log(e)}function w(e,t,n){function r(){e.removeListener(t,r),i||(i=!0,n.apply(e,arguments))}var i=!1;return r.listener=n,r}function y(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function L(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}function b(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function E(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function M(e,t){return{configurable:!0,enumerable:!0,get:e,set:t}}function _(e){function t(e){for(var t=e.identifier,n=0;n<c.length;n++)if(c[n]&&c[n].touch&&c[n].touch.identifier===t)return n;return-1}function n(){l||(l=!0,e.addEventListener("touchstart",i,!1),e.addEventListener("touchmove",o,!1),e.addEventListener("touchend",s,!1),e.addEventListener("touchcancel",s,!1))}function r(){l&&(l=!1,f=0,c[0]=null,c[1]=null,h=0,d=!1,e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchmove",o,!1),e.removeEventListener("touchend",s,!1),e.removeEventListener("touchcancel",s,!1))}function i(n){for(var r=0;r<n.changedTouches.length;r++){var i=n.changedTouches[r];if(-1===t(i.identifier)&&f<2){var o=0===f,s=c[0]?1:0,l=c[0]?0:1,v=new x;c[s]=v,f++,v.touch=i,K(i,e,v.position);var p=c[l]?c[l].touch:void 0;if(a.emit("place",i,p),!o){var m=u();d=!1,a.emit("start",m),h=m}}}}function o(n){for(var r=!1,i=0;i<n.changedTouches.length;i++){var o=n.changedTouches[i],s=t(o);-1!==s&&(r=!0,c[s].touch=o,K(o,e,c[s].position))}if(2===f&&r){var d=u();a.emit("change",d,h),h=d}}function s(e){for(var n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],i=t(r);if(-1!==i){c[i]=null,f--;var o=0===i?1:0,s=c[o]?c[o].touch:void 0;a.emit("lift",r,s)}}d||2===f||(d=!0,a.emit("end"))}function u(){return f<2?0:V(c[0].position,c[1].position)}e=e||window;var a=new G,c=[null,null],f=0,h=0,d=!1,l=!1;return Object.defineProperties(a,{pinching:Z(function(){return 2===f}),fingers:Z(function(){return c})}),n(),a.enable=n,a.disable=r,a.indexOfTouch=t,a}function x(){this.position=[0,0],this.touch=null}function C(e){function t(){x||(x=!0,E&&(p=Y(m,function(e,t){E(t)},!0)),M&&(m.addEventListener("mousedown",c,!1),g.addEventListener("mousemove",h,!1),g.addEventListener("mouseup",f,!1)),(M||_)&&(v=J(m),m.addEventListener("touchstart",r,!1),M&&(m.addEventListener("touchmove",i,!1),v.on("place",o),v.on("lift",s)),_&&v.on("change",a)))}function n(){x&&(x=!1,p&&m.removeEventListener("wheel",p),v&&(v.disable(),m.removeEventListener("touchstart",r,!1),M&&m.removeEventListener("touchmove",i,!1)),M&&(g.removeEventListener("mousedown",c,!1),g.removeEventListener("mousemove",h,!1),g.removeEventListener("mouseup",f,!1)))}function r(e){e.preventDefault()}function i(e){if(y&&!u())for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches[t],r=v.indexOfTouch(n),i=_?-1!==r:0===r;if(i){h(n);break}}}function o(e,t){if(y=!u()){c(t||e)}}function s(e,t){var n=v.fingers.reduce(function(e,t){return e+(t?1:0)},0);(y=_&&n>=1)&&t&&K(t,m,w)}function u(){return v.pinching&&_}function a(e,t){_(e-t)}function c(e){K(e,m,w),d(w)&&(y=!0)}function f(){y=!1}function h(e){var t=K(e,m,L);if(v&&u())return void(w=t);if(y){var n=l(b),r=(t[0]-w[0])/n[0],i=(t[1]-w[1])/n[1];M(r,i),w[0]=t[0],w[1]=t[1]}}function d(e){if(m===window||m===document||m===document.body)return!0;var t=m.getBoundingClientRect();return e[0]>=0&&e[1]>=0&&e[0]<t.width&&e[1]<t.height}function l(e){var t=m;return t!==window&&t!==document&&t!==document.body||(t=document.documentElement),e[0]=t.clientWidth,e[1]=t.clientHeight,e}var v,p,m=e.element||window,g=e.parent||m,w=[0,0],y=!1,L=[0,0],b=[0,0],E=e.zoom,M=e.rotate,_=e.pinch,x=!1;return t(),{isDragging:function(){return y},isPinching:u,enable:t,disable:n}}function B(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function T(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function z(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s),e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=o*s),e}function P(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],u=n[1],a=n[2];return e[0]=i*a-o*u,e[1]=o*s-r*a,e[2]=r*u-i*s,e}function S(e,t,n){var r=ee(t,n)+1;return r<se?(r=0,Math.abs(t[0])>Math.abs(t[2])?te(oe,-t[1],t[0],0):te(oe,0,-t[2],t[1])):ie(oe,t,n),e[0]=oe[0],e[1]=oe[1],e[2]=oe[2],e[3]=r,re(e,e),e}function k(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o,u=s?1/s:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-i*u,e[3]=o*u,e}function O(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function A(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function j(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function D(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],u=n[1],a=n[2],c=n[3],f=c*r+u*o-a*i,h=c*i+a*r-s*o,d=c*o+s*i-u*r,l=-s*r-u*i-a*o;return e[0]=f*c+l*-s+h*-a-d*-u,e[1]=h*c+l*-u+d*-s-f*-a,e[2]=d*c+l*-a+f*-u-h*-s,e}function H(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function I(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function q(e){function t(e,t){var n=2*Math.PI;a[0]-=n*e*v.rotateSpeed,a[1]-=n*t*v.rotateSpeed}function n(e){a[2]+=e*v.zoomSpeed}function r(e){a[2]-=e*v.pinchSpeed}function i(){var e=v.up||me;ue(f,e,me),ae(h,f);var t=v.distance;pe.subtract(c,v.position,v.target),pe.transformQuat(c,c,f);var n=Math.atan2(c[0],c[2]),r=Math.atan2(Math.sqrt(c[0]*c[0]+c[2]*c[2]),c[1]);n+=a[0],r+=a[1],n=Q(n,v.thetaBounds[0],v.thetaBounds[1]),r=Q(r,v.phiBounds[0],v.phiBounds[1]),r=Q(r,ge,Math.PI-ge),t+=a[2],t=Q(t,v.distanceBounds[0],v.distanceBounds[1]);var i=Math.abs(t)<=ge?ge:t;c[0]=i*Math.sin(r)*Math.sin(n),c[1]=i*Math.cos(r),c[2]=i*Math.sin(r)*Math.cos(n),d=r,l=n,v.distance=t,pe.transformQuat(c,c,h),pe.add(v.position,v.target,c),W(v.direction,e,v.position,v.target)}function o(){i();for(var e="number"==typeof v.damping?v.damping:1,t=0;t<a.length;t++)a[t]*=1-e}function s(e,t,n){e&&pe.copy(e,v.position),t&&pe.copy(t,v.direction),n&&pe.copy(n,v.up)}function u(){var e=v.phi,t=v.theta;t=Q(t,v.thetaBounds[0],v.thetaBounds[1]),e=Q(e,v.phiBounds[0],v.phiBounds[1]),e=Q(e,ge,Math.PI-ge);var n=Math.max(ge,v.distance);v.position[0]=n*Math.sin(e)*Math.sin(t),v.position[1]=n*Math.cos(e),v.position[2]=n*Math.sin(e)*Math.cos(t),pe.add(v.position,v.position,v.target),i()}e=e||{};var a=[0,0,0],c=[0,0,0],f=[0,0,0,1],h=f.slice(),d=N(e.phi,Math.PI/2),l=e.theta||0,v={update:o,copyInto:s,position:e.position?e.position.slice():[0,0,1],direction:[0,0,-1],up:e.up?e.up.slice():[0,1,0],target:e.target?e.target.slice():[0,0,0],distance:N(e.distance,1),damping:N(e.damping,.25),rotateSpeed:N(e.rotateSpeed,.28),zoomSpeed:N(e.zoomSpeed,.0075),pinchSpeed:N(e.pinchSpeed,.0075),pinch:!1!==e.pinching,zoom:!1!==e.zoom,rotate:!1!==e.rotate,phiBounds:e.phiBounds||[0,Math.PI],thetaBounds:e.thetaBounds||[-1/0,1/0],distanceBounds:e.distanceBounds||[0,1/0]};"number"!=typeof e.distance&&(pe.subtract(we,v.position,v.target),v.distance=pe.length(we));var p=$({parent:e.parent||window,element:e.element,rotate:!1!==e.rotate?t:null,zoom:!1!==e.zoom?n:null,pinch:!1!==e.pinch?r:null});return v.enable=p.enable,v.disable=p.disable,Object.defineProperties(v,{phi:{get:function(){return d},set:function(e){d=e,u()}},theta:{get:function(){return l},set:function(e){l=e,u()}},dragging:{get:function(){return p.isDragging()}},pinching:{get:function(){return p.isPinching()}}}),u(),v}function W(e,t,n,r){pe.copy(e,r),pe.subtract(e,e,n),pe.normalize(e,e)}var N=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},Q=e,R=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t},U=r,X=96,Y=i,F={left:0,top:0},K=o,V=u;a.prototype=Object.create(null),c.EventEmitter=c,c.usingDomains=!1,c.prototype.domain=void 0,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.init=function(){this.domain=null,c.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new a,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(e){var t,n,r,i,o,s,u,a="error"===e;if(s=this._events)a=a&&null==s.error;else if(!a)return!1;if(u=this.domain,a){if(t=arguments[1],!u){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=u,t.domainThrown=!1,u.emit("error",t),!1}if(!(n=s[e]))return!1;var f="function"==typeof n;switch(r=arguments.length){case 1:h(n,f,this);break;case 2:d(n,f,this,arguments[1]);break;case 3:l(n,f,this,arguments[1],arguments[2]);break;case 4:v(n,f,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];p(n,f,this,i)}return!0},c.prototype.addListener=function(e,t){return m(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return m(this,e,t,!0)},c.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,w(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,w(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new a:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new a,this;delete r[e]}else L(n,i);r.removeListener&&this.emit("removeListener",e,s||t)}return this},c.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new a,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new a:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new a,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},c.prototype.listeners=function(e){var t,n,r=this._events;return r?(t=r[e],n=t?"function"==typeof t?[t.listener||t]:E(t):[]):n=[],n},c.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):y.call(e,t)},c.prototype.listenerCount=y,c.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Z=M,G=c.EventEmitter,J=_,$=C,ee=B,te=T,ne=z,re=ne,ie=P,oe=[0,0,0],se=1e-6,ue=S,ae=k,ce=O,fe=A,he=j,de=D,le=H,ve=I,pe={length:ce,add:fe,subtract:he,transformQuat:de,copy:le,normalize:ve,cross:ie},me=[0,1,0],ge=Math.pow(2,-23),we=[0,0,0];return q});